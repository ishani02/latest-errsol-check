'use strict'

var KoaHook = {};

function wraplisten(_listen, app) {
  return function () {
    if(process.env && process.env.ERRSOLE_MAIN_APP_PORT && process.env.ERRSOLE_APP_PORT && process.env.ERRSOLE_PORTS) {
      arguments[0] = process.env.ERRSOLE_APP_PORT;
    }
    return _listen.call(app, ...arguments);
  }
}

KoaHook.setupHandler = function(app) {
  app.listen = wraplisten(app.listen, app);
}

module.exports = KoaHook;
