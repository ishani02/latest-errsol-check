'use strict';var a0_0x4d500f=a0_0x556f;(function(_0x5ee86e,_0xbcc60c){var _0xaad47e=a0_0x556f,_0x394f1c=_0x5ee86e();while(!![]){try{var _0x366a11=-parseInt(_0xaad47e(0x122))/0x1*(-parseInt(_0xaad47e(0x139))/0x2)+-parseInt(_0xaad47e(0x10e))/0x3*(parseInt(_0xaad47e(0x116))/0x4)+-parseInt(_0xaad47e(0x118))/0x5+parseInt(_0xaad47e(0x10f))/0x6+parseInt(_0xaad47e(0x13e))/0x7+-parseInt(_0xaad47e(0x131))/0x8*(-parseInt(_0xaad47e(0x117))/0x9)+parseInt(_0xaad47e(0x138))/0xa*(-parseInt(_0xaad47e(0x129))/0xb);if(_0x366a11===_0xbcc60c)break;else _0x394f1c['push'](_0x394f1c['shift']());}catch(_0x3a403f){_0x394f1c['push'](_0x394f1c['shift']());}}}(a0_0x5ca6,0xbf794));const FS=require('fs'),Path=require('path'),{v4:uuidv4}=require('uuid');var Events=require(a0_0x4d500f(0x13d)),appConfig=require('../../../config'),pendingHTTPRequests=appConfig['getPendingHTTPRequests'](),ExpressHook={},isExpressWrapped=!0x1;function wrapExpress(_0x48392b){var _0x5ba39d=a0_0x4d500f,_0x57fda4=function(){var _0x227108=a0_0x556f,_0x4e0560=_0x48392b();return _0x4e0560['use'](errsoleWatcher),_0x4e0560['use'](errsoleResponseCapture),_0x4e0560[_0x227108(0x11c)]=wraplisten(_0x4e0560['listen'],_0x4e0560),process[_0x227108(0x111)](function(){var _0x3029e0=_0x227108;_0x4e0560[_0x3029e0(0x134)](errsoleErrorHandler);}),_0x4e0560;};return Object[_0x5ba39d(0x12b)](_0x57fda4,_0x48392b),isExpressWrapped=!0x0,_0x57fda4;}function wraplisten(_0x53051c,_0x16b470){return function(){var _0x1579de=a0_0x556f,_0x5dfc43=arguments[0x0];return appConfig['addMainProcessPort'](_0x5dfc43),appConfig[_0x1579de(0x13a)](_0x5dfc43),_0x53051c['call'](_0x16b470,...arguments);};}function a0_0x556f(_0x13adcb,_0x12b2c7){var _0x5ca68b=a0_0x5ca6();return a0_0x556f=function(_0x556fee,_0x325373){_0x556fee=_0x556fee-0x10d;var _0x7248ad=_0x5ca68b[_0x556fee];return _0x7248ad;},a0_0x556f(_0x13adcb,_0x12b2c7);}function errsoleErrorHandler(_0x29db74,_0x462336,_0x90a0b1,_0x2e1fcb){var _0x32bfcd=a0_0x4d500f;_0x462336[_0x32bfcd(0x11a)][_0x32bfcd(0x13c)]=_0x29db74,_0x2e1fcb(_0x29db74);}function errsoleWatcher(_0x237010,_0x645aa7,_0x5813ef){var _0x2264ac=a0_0x4d500f;_0x237010[_0x2264ac(0x11a)]={},_0x237010[_0x2264ac(0x11a)]['id']=uuidv4(),Events[_0x2264ac(0x11b)](Events[_0x2264ac(0x115)],_0x237010);var _0x56d9a4=process[_0x2264ac(0x113)]['bigint']();if(!(_0x3f3113=getErrsoleSessonId(_0x237010))){var _0x3f3113=uuidv4();_0x645aa7=setErrsoleSessionId(_0x645aa7,_0x3f3113);}var _0x547b15=function(){var _0x263c5f=_0x2264ac;_0x237010[_0x263c5f(0x11a)][_0x263c5f(0x132)]=((process[_0x263c5f(0x113)][_0x263c5f(0x136)]()-_0x56d9a4)/0xf4240n)[_0x263c5f(0x120)](),_0x237010['errsole'][_0x263c5f(0x121)]=_0x3f3113,Events[_0x263c5f(0x11b)](Events[_0x263c5f(0x114)],_0x237010),Events['emit'](Events['HTTP_RESPONSE_SENT'],{'request':_0x237010,'response':_0x645aa7});};if(!_0x645aa7[_0x2264ac(0x125)])throw new Error(_0x2264ac(0x11f));if(_0x645aa7[_0x2264ac(0x125)]['finish'])_0x645aa7['on'](_0x2264ac(0x110),_0x547b15);else{if(!_0x645aa7[_0x2264ac(0x125)][_0x2264ac(0x12c)])throw new Error(_0x2264ac(0x11f));_0x645aa7['on']('close',_0x547b15);}_0x5813ef();}function errsoleResponseCapture(_0x439329,_0x12949c,_0x2f983d){var _0x191e25=a0_0x4d500f;_0x439329[_0x191e25(0x11a)][_0x191e25(0x12f)]='';var _0x1f9fc6=_0x12949c[_0x191e25(0x112)];if(_0x12949c[_0x191e25(0x112)]=function(_0xd794d4,_0x2f769a,_0x12af73){var _0x2f5b57=_0x191e25;_0xd794d4?Buffer[_0x2f5b57(0x13b)](_0xd794d4)?_0x439329['errsole']['responseBody']+=_0xd794d4[_0x2f5b57(0x120)](_0x2f769a):_0x2f5b57(0x12a)==typeof _0xd794d4?_0x439329[_0x2f5b57(0x11a)]['responseBody']+=_0xd794d4:_0x439329[_0x2f5b57(0x11a)][_0x2f5b57(0x12f)]=_0x2f5b57(0x126):_0x439329[_0x2f5b57(0x11a)][_0x2f5b57(0x12f)]+='',_0x1f9fc6['call'](_0x12949c,_0xd794d4,_0x2f769a,_0x12af73);},parseInt(process[_0x191e25(0x12e)][_0x191e25(0x119)])>=0x8){var _0x1486c6=_0x12949c[_0x191e25(0x127)];_0x12949c['end']=function(_0x40a7c5,_0x18438c){var _0x412d81=_0x191e25;_0x40a7c5?Buffer[_0x412d81(0x13b)](_0x40a7c5)?_0x439329['errsole'][_0x412d81(0x12f)]+=_0x40a7c5[_0x412d81(0x120)](_0x18438c):_0x412d81(0x12a)==typeof _0x40a7c5?_0x439329[_0x412d81(0x11a)][_0x412d81(0x12f)]+=_0x40a7c5:_0x439329[_0x412d81(0x11a)][_0x412d81(0x12f)]=_0x412d81(0x126):_0x439329[_0x412d81(0x11a)][_0x412d81(0x12f)]+='',_0x1486c6[_0x412d81(0x135)](_0x12949c,_0x40a7c5,_0x18438c);};}_0x2f983d();}function getErrsoleSessonId(_0x2c7f04){var _0x259cb0=a0_0x4d500f;try{if(!_0x2c7f04[_0x259cb0(0x137)]||!_0x2c7f04[_0x259cb0(0x137)][_0x259cb0(0x133)])return null;var _0x2f9865=appConfig[_0x259cb0(0x128)](),_0x5ccaa9=get_cookies(_0x2c7f04)[_0x2f9865];if(_0x5ccaa9)return _0x5ccaa9;}catch(_0x401714){return console[_0x259cb0(0x13c)](_0x401714),null;}}function a0_0x5ca6(){var _0x3e66c6=['use','call','bigint','headers','10HTQnlP','4KQzMCp','addWrappedPorts','isBuffer','error','../../eventCapture/events','2726304XoKKsN','forEach','561VuwbTH','4029120jxcfWV','finish','nextTick','write','hrtime','REMOVE_HTTP_REQUEST_LOG','ADD_HTTP_REQUEST_LOG','29572svsFwu','162jNFgGl','3785115GpekFo','node','errsole','emit','listen','split','trim','unable\x20to\x20attach\x20error\x20watcher','toString','errsoleSessionId','598681rzKGDn','setupHandler','express','_events','Response\x20not\x20available','end','getSessionName','5142522zqllII','string','setPrototypeOf','close','packages','versions','responseBody','match','503528DeWeho','responseTime','cookie'];a0_0x5ca6=function(){return _0x3e66c6;};return a0_0x5ca6();}function setErrsoleSessionId(_0x1a36d2,_0x420ae7){var _0x360704=a0_0x4d500f;try{var _0x5b1e6d=appConfig[_0x360704(0x128)]();_0x1a36d2[_0x360704(0x133)](_0x5b1e6d,_0x420ae7);}catch(_0x27e1f2){console[_0x360704(0x13c)](_0x27e1f2);}return _0x1a36d2;}function get_cookies(_0x1f28a0){var _0x28772a=a0_0x4d500f,_0x433d32={};try{_0x1f28a0[_0x28772a(0x137)]&&_0x1f28a0[_0x28772a(0x137)][_0x28772a(0x133)][_0x28772a(0x11d)](';')[_0x28772a(0x10d)](function(_0x6e174){var _0x3400e5=_0x28772a,_0x4cf401=_0x6e174[_0x3400e5(0x130)](/(.*?)=(.*)$/);_0x433d32[_0x4cf401[0x1][_0x3400e5(0x11e)]()]=(_0x4cf401[0x2]||'')[_0x3400e5(0x11e)]();});}catch(_0x105e18){}return _0x433d32;}ExpressHook[a0_0x4d500f(0x123)]=function(_0x191e42){var _0x4b4ddd=a0_0x4d500f;isExpressWrapped||(_0x191e42['use'](errsoleWatcher),_0x191e42[_0x4b4ddd(0x134)](errsoleResponseCapture),_0x191e42[_0x4b4ddd(0x11c)]=wraplisten(_0x191e42[_0x4b4ddd(0x11c)],_0x191e42),process['nextTick'](function(){_0x191e42['use'](errsoleErrorHandler);}));},ExpressHook[a0_0x4d500f(0x12d)]=[{'name':a0_0x4d500f(0x124),'wrapper':wrapExpress}],module['exports']=ExpressHook;